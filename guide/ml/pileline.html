<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>写在前面 | favorhau的随笔</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="favorhau">
    
    <link rel="preload" href="/assets/css/0.styles.05b5a4f8.css" as="style"><link rel="preload" href="/assets/js/app.02681985.js" as="script"><link rel="preload" href="/assets/js/2.de1ff954.js" as="script"><link rel="preload" href="/assets/js/29.b4958f19.js" as="script"><link rel="prefetch" href="/assets/js/10.155849ec.js"><link rel="prefetch" href="/assets/js/11.efc31f36.js"><link rel="prefetch" href="/assets/js/12.d0b5a2de.js"><link rel="prefetch" href="/assets/js/13.82fc6fc7.js"><link rel="prefetch" href="/assets/js/14.73268a60.js"><link rel="prefetch" href="/assets/js/15.1cda9909.js"><link rel="prefetch" href="/assets/js/16.6c393d95.js"><link rel="prefetch" href="/assets/js/17.e521e3ee.js"><link rel="prefetch" href="/assets/js/18.ffdc65b5.js"><link rel="prefetch" href="/assets/js/19.a1573b6c.js"><link rel="prefetch" href="/assets/js/20.f4ea8b56.js"><link rel="prefetch" href="/assets/js/21.b5affafe.js"><link rel="prefetch" href="/assets/js/22.1db33c57.js"><link rel="prefetch" href="/assets/js/23.61f67fc0.js"><link rel="prefetch" href="/assets/js/24.f231101c.js"><link rel="prefetch" href="/assets/js/25.fd7f1804.js"><link rel="prefetch" href="/assets/js/26.15f59fe3.js"><link rel="prefetch" href="/assets/js/27.9a18b239.js"><link rel="prefetch" href="/assets/js/28.83e6c8a2.js"><link rel="prefetch" href="/assets/js/3.de4aad32.js"><link rel="prefetch" href="/assets/js/30.c5c32088.js"><link rel="prefetch" href="/assets/js/31.d2615163.js"><link rel="prefetch" href="/assets/js/32.4cedcdc4.js"><link rel="prefetch" href="/assets/js/33.2a2d8dc8.js"><link rel="prefetch" href="/assets/js/34.58d925a1.js"><link rel="prefetch" href="/assets/js/4.5c2554a9.js"><link rel="prefetch" href="/assets/js/5.c536c2f4.js"><link rel="prefetch" href="/assets/js/6.41f85f5f.js"><link rel="prefetch" href="/assets/js/7.de80cca0.js"><link rel="prefetch" href="/assets/js/8.59406a95.js"><link rel="prefetch" href="/assets/js/9.4b66b608.js">
    <link rel="stylesheet" href="/assets/css/0.styles.05b5a4f8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">favorhau的随笔</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/art.html" class="nav-link">
  视觉传达
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/art.html" class="nav-link">
  视觉传达
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>机器学习</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/ml/aereport1.html" class="sidebar-link">机器学习任务</a></li><li><a href="/guide/ml/note.html" class="sidebar-link">机器学习相关库</a></li><li><a href="/guide/ml/pileline.html" aria-current="page" class="active sidebar-link">深度学习</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/ml/pileline.html#写在前面" class="sidebar-link">写在前面</a></li><li class="sidebar-sub-header"><a href="/guide/ml/pileline.html#线性回归-从0到1" class="sidebar-link">线性回归-从0到1</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/ml/pileline.html#生成数据集" class="sidebar-link">生成数据集</a></li><li class="sidebar-sub-header"><a href="/guide/ml/pileline.html#数据集读取" class="sidebar-link">数据集读取</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTTP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="写在前面"><a href="#写在前面" class="header-anchor">#</a> 写在前面</h2> <p>这个column是记录在深度学习路上的一笔一划，旨在与记录机器学习过程当中遇到的一些问题</p> <p>使用的深度学习框架为<code>mxnet</code></p> <h2 id="线性回归-从0到1"><a href="#线性回归-从0到1" class="header-anchor">#</a> 线性回归-从0到1</h2> <h3 id="生成数据集"><a href="#生成数据集" class="header-anchor">#</a> 生成数据集</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#生成数据集</span>
<span class="token operator">%</span>matplotlib inline<span class="token comment">#notebook内展示图片</span>
<span class="token keyword">from</span> IPython <span class="token keyword">import</span> display
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> mxnet <span class="token keyword">import</span> autograd<span class="token punctuation">,</span> nd
<span class="token keyword">import</span> random
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>num_input <span class="token operator">=</span> <span class="token number">2</span>
num_examples <span class="token operator">=</span> <span class="token number">1000</span>
true_w <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
true_b <span class="token operator">=</span> <span class="token number">4.2</span>
features <span class="token operator">=</span> nd<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>scale<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> 
                           shape<span class="token operator">=</span><span class="token punctuation">(</span>num_examples<span class="token punctuation">,</span>num_input<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#features[:, 0]表示第0列，shape=(num_examples,1)的矩阵（向量），类推。</span>
labels <span class="token operator">=</span> true_w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> features<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> true_w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> features<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> true_b
labels <span class="token operator">+=</span> nd<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>scale<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> shape<span class="token operator">=</span>labels<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">use_svg_display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    display<span class="token punctuation">.</span>set_matplotlib_formats<span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">set_figsize</span><span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3.5</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    use_svg_display<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'figure.figsize'</span><span class="token punctuation">]</span><span class="token operator">=</span>figsize
    
set_figsize<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/notebook/image-20210531163016067.png" alt="image-20210531163016067"></p> <h3 id="数据集读取"><a href="#数据集读取" class="header-anchor">#</a> 数据集读取</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#读取数据集</span>
<span class="token keyword">def</span> <span class="token function">data_iter</span><span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span> features<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    num_examples <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>features<span class="token punctuation">)</span>
    indices <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>num_examples<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#序列化样本数目</span>
    random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>indices<span class="token punctuation">)</span><span class="token comment">#随机样本</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_examples<span class="token punctuation">,</span> batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
        i <span class="token operator">=</span> nd<span class="token punctuation">.</span>array<span class="token punctuation">(</span>indices<span class="token punctuation">[</span>j<span class="token punctuation">:</span> <span class="token builtin">min</span><span class="token punctuation">(</span>j <span class="token operator">+</span> batch_size<span class="token punctuation">,</span> num_examples<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">yield</span> features<span class="token punctuation">.</span>take<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token punctuation">.</span>take<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token comment">#根据索引返回对应元素，返回迭代器</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>batch_size <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">for</span> X<span class="token punctuation">,</span>y <span class="token keyword">in</span> data_iter<span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span>features<span class="token punctuation">,</span>labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
    <span class="token keyword">break</span><span class="token comment">#退出迭代器再次迭代</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/ml/note.html" class="prev">
        机器学习相关库
      </a></span> <span class="next"><a href="/guide/http/learn.html">
        HTTP基础
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.02681985.js" defer></script><script src="/assets/js/2.de1ff954.js" defer></script><script src="/assets/js/29.b4958f19.js" defer></script>
  </body>
</html>
